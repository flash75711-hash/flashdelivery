<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
      direction: rtl;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #007AFF;
    }
    .test-section {
      margin: 20px 0;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 5px;
    }
    button {
      background: #007AFF;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background: #0056b3;
    }
    .result {
      margin-top: 10px;
      padding: 10px;
      border-radius: 5px;
    }
    .success {
      background: #d4edda;
      color: #155724;
    }
    .error {
      background: #f8d7da;
      color: #721c24;
    }
    input {
      padding: 8px;
      margin: 5px;
      border: 1px solid #ddd;
      border-radius: 4px;
      width: 300px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h1>
    
    <div class="test-section">
      <h2>1. Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ</h2>
      <p>Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø­Ø§Ù„ÙŠØ§Ù‹</p>
      <button onclick="testCustomerNotification()">Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
      <div id="result1" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
      <h2>2. Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù„Ø³Ø§Ø¦Ù‚</h2>
      <p>Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù„Ø³Ø§Ø¦Ù‚ Ù…Ø¹ÙŠÙ† (Ù…Ø·Ù„ÙˆØ¨ ID Ø§Ù„Ø³Ø§Ø¦Ù‚)</p>
      <input type="text" id="driverId" placeholder="Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ø³Ø§Ø¦Ù‚">
      <button onclick="testDriverNotification()">Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø³Ø§Ø¦Ù‚</button>
      <div id="result2" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
      <h2>3. Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¨Ø· Ø¨Ø·Ù„Ø¨</h2>
      <p>Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¨Ø· Ø¨Ø·Ù„Ø¨ Ù…Ø¹ÙŠÙ†</p>
      <input type="text" id="userId" placeholder="Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
      <input type="text" id="orderId" placeholder="Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ø·Ù„Ø¨">
      <button onclick="testOrderNotification()">Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø·Ù„Ø¨</button>
      <div id="result3" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
      <h2>4. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</h2>
      <button onclick="getCurrentUser()">Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>
      <div id="userInfo" class="result" style="display:none;"></div>
    </div>
  </div>

  <script type="module">
    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ù…Ù†ÙØ°
    
    async function testCustomerNotification() {
      const resultDiv = document.getElementById('result1');
      resultDiv.style.display = 'block';
      resultDiv.className = 'result';
      resultDiv.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
      
      try {
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
        if (window.testNotifications) {
          await window.testNotifications.testCustomerNotification();
          resultDiv.className = 'result success';
          resultDiv.textContent = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­! ØªØ­Ù‚Ù‚ Ù…Ù† Ø¸Ù‡ÙˆØ±Ù‡ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.';
        } else {
          resultDiv.className = 'result error';
          resultDiv.textContent = 'âŒ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±. ØªØ£ÙƒØ¯ Ù…Ù† ÙØªØ­ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.';
        }
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = 'âŒ Ø®Ø·Ø£: ' + error.message;
      }
    }

    async function testDriverNotification() {
      const driverId = document.getElementById('driverId').value;
      const resultDiv = document.getElementById('result2');
      resultDiv.style.display = 'block';
      resultDiv.className = 'result';
      
      if (!driverId) {
        resultDiv.className = 'result error';
        resultDiv.textContent = 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ID Ø§Ù„Ø³Ø§Ø¦Ù‚';
        return;
      }
      
      resultDiv.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
      
      try {
        if (window.testNotifications) {
          await window.testNotifications.testDriverNotification(driverId);
          resultDiv.className = 'result success';
          resultDiv.textContent = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø³Ø§Ø¦Ù‚ Ø¨Ù†Ø¬Ø§Ø­! ØªØ­Ù‚Ù‚ Ù…Ù† Ø¸Ù‡ÙˆØ±Ù‡ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.';
        } else {
          resultDiv.className = 'result error';
          resultDiv.textContent = 'âŒ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±.';
        }
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = 'âŒ Ø®Ø·Ø£: ' + error.message;
      }
    }

    async function testOrderNotification() {
      const userId = document.getElementById('userId').value;
      const orderId = document.getElementById('orderId').value;
      const resultDiv = document.getElementById('result3');
      resultDiv.style.display = 'block';
      resultDiv.className = 'result';
      
      if (!userId || !orderId) {
        resultDiv.className = 'result error';
        resultDiv.textContent = 'âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ID Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ùˆ ID Ø§Ù„Ø·Ù„Ø¨';
        return;
      }
      
      resultDiv.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
      
      try {
        if (window.testNotifications) {
          await window.testNotifications.testOrderNotification(userId, orderId);
          resultDiv.className = 'result success';
          resultDiv.textContent = 'âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­! ØªØ­Ù‚Ù‚ Ù…Ù† Ø¸Ù‡ÙˆØ±Ù‡ ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.';
        } else {
          resultDiv.className = 'result error';
          resultDiv.textContent = 'âŒ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±.';
        }
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = 'âŒ Ø®Ø·Ø£: ' + error.message;
      }
    }

    async function getCurrentUser() {
      const userInfoDiv = document.getElementById('userInfo');
      userInfoDiv.style.display = 'block';
      userInfoDiv.className = 'result';
      userInfoDiv.textContent = 'Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª...';
      
      try {
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Supabase Ù…Ù† window
        if (window.supabase) {
          const { data: { user } } = await window.supabase.auth.getUser();
          if (user) {
            userInfoDiv.className = 'result success';
            userInfoDiv.innerHTML = `
              <strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong><br>
              ID: ${user.id}<br>
              Email: ${user.email || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}<br>
              Phone: ${user.phone || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}
            `;
          } else {
            userInfoDiv.className = 'result error';
            userInfoDiv.textContent = 'âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„';
          }
        } else {
          userInfoDiv.className = 'result error';
          userInfoDiv.textContent = 'âŒ Supabase ØºÙŠØ± Ù…ØªÙˆÙØ±. ØªØ£ÙƒØ¯ Ù…Ù† ÙØªØ­ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚.';
        }
      } catch (error) {
        userInfoDiv.className = 'result error';
        userInfoDiv.textContent = 'âŒ Ø®Ø·Ø£: ' + error.message;
      }
    }

    // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¯ÙˆØ§Ù„ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ù…
    window.testCustomerNotification = testCustomerNotification;
    window.testDriverNotification = testDriverNotification;
    window.testOrderNotification = testOrderNotification;
    window.getCurrentUser = getCurrentUser;
  </script>
</body>
</html>

