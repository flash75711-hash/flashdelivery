# ุฅุตูุงุญุงุช ุฅุดุนุงุฑ ุงูุนููู ุนูุฏ ูุจูู ุงูุทูุจ

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุชูุญูุฏ ุงูุฑุณุงุฆู
- **ุงููุดููุฉ**: ุฑุณุงูุชุงู ูุฎุชููุชุงู ุชุธูุฑุงู ููุนููู
- **ุงูุญู**: ุชูุญูุฏ ุงูุฑุณุงูุฉ ูู `useOrderNotifications` ูุชุทุงุจู ุงูุฑุณุงูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุงูููู**: `hooks/useOrderNotifications.ts`
- **ุงูุชุบููุฑ**: 
  - ูุจู: "ุชู ูุจูู ุทูุจู ูู ูุจู ุณุงุฆู. ุณูุชู ุงูุชูุงุตู ูุนู ูุฑูุจุงู."
  - ุจุนุฏ: "ุชู ูุจูู ุทูุจู ูุณูุชู ุงูุจุฏุก ูู ุงูุชูุตูู ูุฑูุจุงู."

---

## ๐ ููู ูุนูู ุงููุธุงู ุงูุขู

### 1. ุฅุฑุณุงู ุงูุฅุดุนุงุฑ ูู ุงูุณุงุฆู

#### ูู `driver/trips.tsx`:
```typescript
await supabase.rpc('insert_notification_for_customer_by_driver', {
  p_user_id: order.customer_id,
  p_title: 'ุชู ูุจูู ุทูุจู',
  p_message: 'ุชู ูุจูู ุทูุจู ูุณูุชู ุงูุจุฏุก ูู ุงูุชูุตูู ูุฑูุจุงู.',
  p_type: 'success',
  p_order_id: order.id,
});
```

#### ูู `driver/my-orders.tsx`:
```typescript
await createNotification({
  user_id: order.customer_id,
  title: 'ุชู ูุจูู ุทูุจู',
  message: 'ุชู ูุจูู ุทูุจู ูุณูุชู ุงูุจุฏุก ูู ุงูุชูุตูู ูุฑูุจุงู.',
  type: 'success',
  order_id: order.id,
});
```

### 2. ุธููุฑ ุงูุฅุดุนุงุฑ ููุนููู

#### ุฃ. ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (`useFloatingNotifications`):
- โ ูุณุชูุจู ุงูุฅุดุนุงุฑ ูู ุฌุฏูู `notifications` ุนุจุฑ Realtime
- โ ูุธูุฑ ูู `FloatingNotification` ููุฑุงู
- โ ูุนูู ุนูู Web ู Mobile

#### ุจ. ูู ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ (`useOrderNotifications`):
- โ ูุณุชูุจู ุงูุฅุดุนุงุฑ ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ ุฅูู `accepted`
- โ ูุธูุฑ ูู `FloatingNotification` ููุฑุงู
- โ๏ธ ูุนูู ุนูู Web ููุท
- โ ูุณุชุฎุฏู `shownOrderIds` ูููุน ุงูุฅุดุนุงุฑุงุช ุงูููุฑุฑุฉ

#### ุฌ. ูู NotificationCard:
- โ ูุนุฑุถ ุงูุฅุดุนุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ูุนูู ุนูู Web ู Mobile

---

## ๐ ููุน ุงูุฅุดุนุงุฑุงุช ุงูููุฑุฑุฉ

### ูู `useOrderNotifications`:
```typescript
const addNotification = useCallback((notification: FloatingNotificationData) => {
  // ุชุฌูุจ ุนุฑุถ ููุณ ุงูุฅุดุนุงุฑ ูุฑุชูู
  const notificationId = notification.order_id || notification.id;
  if (shownOrderIds.current.has(notificationId)) {
    return; // ุชุฎุทู ุฅุฐุง ุธูุฑ ูู ูุจู
  }
  shownOrderIds.current.add(notificationId);
  // ...
}, []);
```

**ุงููุชูุฌุฉ**: ุฅุฐุง ุธูุฑ ุฅุดุนุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน `order_id`ุ ูู ูุธูุฑ ุฅุดุนุงุฑ ุขุฎุฑ ูู `useOrderNotifications` ูููุณ `order_id`.

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ุจุนุฏ ุงูุฅุตูุงุญุงุช:
1. โ ุฑุณุงูุฉ ููุญุฏุฉ: "ุชู ูุจูู ุทูุจู ูุณูุชู ุงูุจุฏุก ูู ุงูุชูุตูู ูุฑูุจุงู."
2. โ ุฅุดุนุงุฑ ูุงุญุฏ ููุท ูุธูุฑ ููุนููู (ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนุงุฏุฉ)
3. โ ุงูุฅุดุนุงุฑ ูุธูุฑ ูู `FloatingNotification` ู `NotificationCard`
4. โ ูุนูู ุนูู Web ู Mobile (ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
5. โ ููุน ุงูุฅุดุนุงุฑุงุช ุงูููุฑุฑุฉ ูุนูู ุจุดูู ุตุญูุญ

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

1. ุณุฌู ุฏุฎูู ูุณุงุฆู
2. ูุจู ุทูุจ ูู `driver/trips.tsx` ุฃู `driver/my-orders.tsx`
3. **ุงููุชูุฌุฉ ุงููุชููุนุฉ ููุนููู**:
   - ุฅุดุนุงุฑ ุนุงุฆู: "ุชู ูุจูู ุทูุจู" - "ุชู ูุจูู ุทูุจู ูุณูุชู ุงูุจุฏุก ูู ุงูุชูุตูู ูุฑูุจุงู."
   - ุฅุดุนุงุฑ ูู `NotificationCard` ูู `customer/home.tsx`
   - **ุฅุดุนุงุฑ ูุงุญุฏ ููุท** (ูุง ููุฑุฑ)

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: $(date)
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ

