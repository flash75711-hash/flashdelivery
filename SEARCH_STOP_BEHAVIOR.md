# ุณููู ุงููุธุงู ุจุนุฏ ุงูุชูุงุก ุงูุจุญุซ - ุงููุถุน ุงูููุงุฆู

## โ ุงูุณููู ุงููุฎุชุงุฑ

**ุงูุจุญุซ ูุชููู ูุงูุนููู ูุนูุฏ ุงูุจุญุซ ูุฏููุงู**

---

## ๐ ูุง ูุญุฏุซ ุจุนุฏ 60 ุซุงููุฉ

### 1๏ธโฃ **ุชุญุฏูุซ ุญุงูุฉ ุงูุจุญุซ**
```typescript
search_status: 'searching' โ 'stopped'
status: 'pending' (ูุจูู ููุง ูู)
```

### 2๏ธโฃ **ุฅุดุนุงุฑ ููุนููู**
```
ุงูุนููุงู: "ุงูุชูู ุงูุจุญุซ ุนู ุณุงุฆู"
ุงูุฑุณุงูุฉ: "ูู ูุชู ุงูุนุซูุฑ ุนูู ุณุงุฆู ูู ุงููุทุงู ุงููุญุฏุฏ. ููููู ุฅุนุงุฏุฉ ุงูุจุญุซ ุฃู ุฅูุบุงุก ุงูุทูุจ."
ุงูููุน: warning
```

### 3๏ธโฃ **ูุงุฌูุฉ ุงูุนููู**

#### ูู `OrderCard`:
- โ ูุธูุฑ ุฒุฑ "ุฅุนุงุฏุฉ ุงูุจุญุซ ุนู ุณุงุฆู" (ุฃุฒุฑู)
- โ ูุธูุฑ ุฒุฑ "ุฅูุบุงุก ุงูุทูุจ" (ุฃุญูุฑ)
- โ ุญุงูุฉ ุงูุทูุจ: "ูู ูุชู ุงูุนุซูุฑ ุนูู ุณุงุฆู"

#### ูู ุตูุญุฉ ุชูุงุตูู ุงูุทูุจ (`orders/[id].tsx`):
- โ ูุธูุฑ ุฒุฑ "ุฅุนุงุฏุฉ ุงูุจุญุซ ุนู ุณุงุฆู"
- โ ูุธูุฑ ุฒุฑ "ุฅูุบุงุก ุงูุทูุจ"

#### ูู ุตูุญุฉ ุทูุจุงุชู (`customer/my-orders.tsx`):
- โ ูุธูุฑ ุฒุฑ "ุฅุนุงุฏุฉ ุงูุจุญุซ ุนู ุณุงุฆู" ูู `OrderCard`

### 4๏ธโฃ **ูุงุฌูุฉ ุงูุณุงุฆู**
- โ **ุงูุทูุจุงุช ุงููุชูููุฉ ูุง ุชุธูุฑ** ูู `driver/trips.tsx`
- โ ูุชู ููุชุฑุฉ ุงูุทูุจุงุช: `if (order.search_status === 'stopped') return false;`

---

## ๐ ุนูููุฉ ุฅุนุงุฏุฉ ุงูุจุญุซ

### ุนูุฏูุง ูุถุบุท ุงูุนููู ุนูู "ุฅุนุงุฏุฉ ุงูุจุญุซ ุนู ุณุงุฆู":

1. **ุชุฃููุฏ ูู ุงูุนููู**
   ```
   "ูู ุชุฑูุฏ ุฅุนุงุฏุฉ ุงูุจุญุซ ุนู ุณุงุฆู ููุฐุง ุงูุทูุจุ"
   ```

2. **ุชุญุฏูุซ ุญุงูุฉ ุงูุจุญุซ**
   ```typescript
   search_status: 'stopped' โ 'searching'
   search_started_at: new Date()
   search_expanded_at: null
   driver_id: null
   ```

3. **ุชุญุฏูุฏ ููุทุฉ ุงูุจุญุซ**
   - ุทูุจ ูู ุจุฑู: ุฃูู ุนูุตุฑ ูู `items`
   - ุชูุตูู ุทุฑุฏ: `pickup_address`
   - Fallback: `delivery_address`

4. **ุชุญููู ุงูุนููุงู ุฅูู ุฅุญุฏุงุซูุงุช**
   - ุงุณุชุฎุฏุงู Nominatim API

5. **ุงุณุชุฏุนุงุก `start-order-search`**
   ```typescript
   supabase.functions.invoke('start-order-search', {
     order_id: order.id,
     search_point: { lat, lon }
   })
   ```

6. **ุจุฏุก ุงูุจุญุซ ูู ุฌุฏูุฏ**
   - ุงูุจุญุซ ุนูู 10 ูู ููุฏุฉ 60 ุซุงููุฉ
   - ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ููุณุงุฆููู ูุน ุงููุณุงูุฉ

---

## ๐ ุญุงูุงุช ุงูุทูุจ ุงููุฎุชููุฉ

### ุญุงูุฉ 1: ุงูุจุญุซ ุฌุงุฑู
```
status: 'pending'
search_status: 'searching'
```
- โ ูุธูุฑ `OrderSearchCountdown`
- โ ุงูุนุฏุงุฏ: 60 ุซุงููุฉ
- โ ุฑุณุงูุฉ: "ุงูุจุญุซ ูู ูุทุงู 10 ูู"

### ุญุงูุฉ 2: ุงูุจุญุซ ูุชููู
```
status: 'pending'
search_status: 'stopped'
```
- โ ูุง ูุธูุฑ `OrderSearchCountdown`
- โ ุฑุณุงูุฉ: "ูู ูุชู ุงูุนุซูุฑ ุนูู ุณุงุฆู"
- โ ุฒุฑ "ุฅุนุงุฏุฉ ุงูุจุญุซ ุนู ุณุงุฆู"
- โ ุฒุฑ "ุฅูุบุงุก ุงูุทูุจ"

### ุญุงูุฉ 3: ุงูุทูุจ ููุจูู
```
status: 'accepted'
search_status: 'found' ุฃู 'stopped'
driver_id: UUID
```
- โ ูุง ูุธูุฑ `OrderSearchCountdown`
- โ ุฑุณุงูุฉ: "ููุจูู"
- โ ุฒุฑ "ูุชุงุจุนุฉ ุงูุทูุจ"

### ุญุงูุฉ 4: ุงูุทูุจ ููุบู
```
status: 'cancelled'
```
- โ ูุง ูุธูุฑ `OrderSearchCountdown`
- โ ุฑุณุงูุฉ: "ููุบู"

---

## โ ุงูุชุญูู ูู ุงูุชุทุจูู

### 1. ุจุนุฏ ุงูุชูุงุก ุงูุจุญุซ (60 ุซุงููุฉ):
- [x] `search_status` = `'stopped'`
- [x] ุฅุดุนุงุฑ ููุนููู
- [x] ุฒุฑ "ุฅุนุงุฏุฉ ุงูุจุญุซ" ูุธูุฑ
- [x] ุฒุฑ "ุฅูุบุงุก ุงูุทูุจ" ูุธูุฑ
- [x] `OrderSearchCountdown` ูุฎุชูู
- [x] ุงูุทูุจ ูุง ูุธูุฑ ููุณุงุฆููู

### 2. ุนูุฏ ุฅุนุงุฏุฉ ุงูุจุญุซ:
- [x] ุชุฃููุฏ ูู ุงูุนููู
- [x] `search_status` = `'searching'`
- [x] `search_started_at` = ุงูููุช ุงูุญุงูู
- [x] ุงุณุชุฏุนุงุก `start-order-search`
- [x] ุงูุจุญุซ ูุจุฏุฃ ูู ุฌุฏูุฏ (10 ููุ 60 ุซุงููุฉ)
- [x] `OrderSearchCountdown` ูุธูุฑ ูุฑุฉ ุฃุฎุฑู

---

## ๐ฏ ุงูุฎูุงุตุฉ

โ **ุงููุธุงู ูุนูู ููุง ูู ูุชููุน:**
- ุงูุจุญุซ ูุชููู ุจุนุฏ 60 ุซุงููุฉ
- ุงูุนููู ูุฎุชุงุฑ ุฅุนุงุฏุฉ ุงูุจุญุซ ูุฏููุงู
- ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุงุถุญุฉ
- ุงูุฅุดุนุงุฑุงุช ูุงุถุญุฉ
- ุงูุทูุจุงุช ุงููุชูููุฉ ูุง ุชุธูุฑ ููุณุงุฆููู

โ **ูุง ุญุงุฌุฉ ูุชุบููุฑุงุช ุฅุถุงููุฉ**
