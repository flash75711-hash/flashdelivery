# دليل الإعداد والتشغيل

## المتطلبات الأساسية

- Node.js (الإصدار 18 أو أحدث)
- npm أو yarn
- Expo CLI
- حساب Supabase

## خطوات الإعداد

### 1. تثبيت المتطلبات

```bash
npm install
```

### 2. إعداد Supabase

1. قم بإنشاء مشروع جديد في [Supabase](https://supabase.com)
2. انسخ `URL` و `anon key` من إعدادات المشروع
3. أضفها إلى ملف `.env`:
   ```
   EXPO_PUBLIC_SUPABASE_URL=your_supabase_url
   EXPO_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
   ```

### 3. إعداد قاعدة البيانات

اتبع التعليمات في ملف `DATABASE_SETUP.md` لإنشاء الجداول والسياسات المطلوبة.

### 4. إضافة الأيقونات

أضف الملفات التالية في مجلد `assets/`:
- `icon.png` (1024x1024)
- `splash.png` (1242x2436)
- `adaptive-icon.png` (1024x1024)
- `favicon.png` (48x48)

### 5. تشغيل التطبيق

```bash
# تشغيل على Android
npm run android

# تشغيل على iOS
npm run ios

# تشغيل على الويب
npm run web

# أو استخدم Expo Go
npm start
```

## هيكل المشروع

```
flash/
├── app/                    # شاشات التطبيق (Expo Router)
│   ├── (auth)/            # شاشات المصادقة
│   │   ├── login.tsx
│   │   └── register.tsx
│   ├── (tabs)/            # الشاشات الرئيسية
│   │   ├── customer/      # قسم العميل
│   │   ├── driver/        # قسم السائق
│   │   ├── vendor/        # قسم مزود الخدمة
│   │   └── admin/         # قسم الإدارة
│   └── customer/          # شاشات العميل الإضافية
├── contexts/              # React Contexts
│   └── AuthContext.tsx
├── lib/                   # المكتبات والمساعدات
│   └── supabase.ts
├── i18n/                  # ملفات الترجمة
│   ├── ar.json
│   └── index.ts
├── constants/             # الثوابت
│   └── Colors.ts
└── assets/                # الأصول (أيقونات، صور)
```

## المميزات الرئيسية

### ✅ نظام RBAC
- 4 أدوار مختلفة (عميل، سائق، مزود خدمة، مدير)
- واجهة مخصصة لكل دور
- حماية على مستوى قاعدة البيانات

### ✅ قسم العميل
- طلب توصيل طرد
- طلب شراء من متجر (طلبات من بره)
- البحث عن مزودي الخدمة
- سجل الطلبات

### ✅ قسم السائق
- استقبال وقبول الطلبات
- تتبع الموقع الحي (Realtime)
- محفظة مع حساب العمولة
- سجل الرحلات

### ✅ قسم مزود الخدمة
- إدارة معلومات المتجر
- تحديث الموقع وساعات العمل

### ✅ قسم الإدارة
- لوحة القيادة مع الإحصائيات
- إدارة السائقين
- المحاسبة والمدفوعات
- سجل الطلبات الشامل

## ملاحظات مهمة

1. **الأذونات**: تأكد من طلب أذونات الموقع عند تشغيل التطبيق
2. **Realtime**: تأكد من تفعيل Realtime في Supabase للجداول المطلوبة
3. **RTL**: التطبيق يدعم RTL بشكل كامل
4. **اللغة**: جميع النصوص باللغة العربية

## استكشاف الأخطاء

### مشكلة في الاتصال بـ Supabase
- تحقق من متغيرات البيئة في `.env`
- تأكد من صحة `URL` و `anon key`

### مشكلة في RTL
- أعد تشغيل التطبيق بعد التثبيت الأول
- على iOS، قد تحتاج لإعادة بناء التطبيق

### مشكلة في الأذونات
- تأكد من إضافة الأذونات في `app.json`
- على Android، تحقق من `AndroidManifest.xml`

## الدعم

للمزيد من المعلومات، راجع:
- [Expo Documentation](https://docs.expo.dev)
- [Supabase Documentation](https://supabase.com/docs)
- [React Navigation](https://reactnavigation.org)

